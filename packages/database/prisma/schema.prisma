datasource db {
  provider          = "postgresql"
  url               = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl         = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
}

model Card {
  id               String   @id @default(uuid())
  oracleId         String   @unique
  name             String
  manaCost         String?
  typeLine         String
  oracleText       String?
  colors           String[]

  printings        Printing[]
  legalities       Legality[]
}

model Printing {
  id              String   @id @default(uuid())
  cardId          String
  setCode         String
  releasedAt      DateTime
  collectorNumber String
  rarity          String
  imageUrl        String
  usd             Decimal?
  usdFoil         Decimal?
  usdEtched       Decimal?
  eur             Decimal?
  eurFoil         Decimal?
  tix             Decimal?

  card            Card @relation(fields: [cardId], references: [id], onDelete: Cascade)

  @@unique([cardId, setCode, collectorNumber])
}

model Legality {
  id        String  @id @default(uuid())
  cardId    String  @unique(map: "card_legalities_unique")
  format    String
  legal     Boolean

  card      Card    @relation(fields: [cardId], references: [id], onDelete: Cascade)

  @@unique([cardId, format])
}

model ScryfallMeta {
  key     String  @id
  value   String
}
